/*!
    *
    * Wijmo Library 5.20242.21
    * https://developer.mescius.com/wijmo
    *
    * Copyright(c) MESCIUS inc. All rights reserved.
    *
    * Licensed under the End-User License Agreement For MESCIUS Wijmo Software.
    * us.sales@mescius.com
    * https://developer.mescius.com/wijmo/licensing
    *
    */

"use strict";var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);t.default=e;return t};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=require("react"),wijmo_react_base_1=require("@mescius/wijmo.react.base"),wjcCore=__importStar(require("@mescius/wijmo")),wjcGridDetail=__importStar(require("@mescius/wijmo.grid.detail"));exports.FlexGridDetailMeta={inputs:["detailVisibilityMode","isAnimated","keyActionEnter","maxHeight","rowHasDetail","template"],events:[]};const lastDetailContextKey="$_templateFnLastCtx";exports.FlexGridDetail=react_1.forwardRef((function(e,t){const i=wijmo_react_base_1.useWjComponentChildBase({ref:t,properties:exports.FlexGridDetailMeta.inputs,events:exports.FlexGridDetailMeta.events,props:e,constructor:DirectiveFlexGridDetail,needParentInstance:!0,parentProp:"",isParentPropArray:!1,assignedToParent:!1});return Object.assign({$_wjComponent:!0},i)}));class DirectiveFlexGridDetail extends wjcGridDetail.FlexGridDetailProvider{constructor(e,t){super(e,t);this.renderedCellsCache=[];this._createDetailCellFn=e=>{const t={row:e,item:e.dataItem,provider:this},i=this._templateFn;if(!i)return;const r=document.createElement("div"),a=i(t);r[lastDetailContextKey]=t;wijmo_react_base_1.selectiveDomRender(a,r);this.renderedCellsCache.push(r);return r};this._disposeDetailCellFn=e=>{const t=e.detail;wijmo_react_base_1.selectiveDomUnmount(t);let i=-1;for(let e=0;e<this.renderedCellsCache.length;e++)if(this.renderedCellsCache[e]==t){i=e;break}i>-1&&this.renderedCellsCache.splice(i,1)}}get template(){return this._templateFn}set template(e){this._templateFn!=e&&(this._templateFn=wjcCore.asFunction(e,!0))}initialize(e){wjcCore.copy(this,e,!1);this.updateTemplate()}updateTemplate(){if(this._templateFn)for(let e of this.renderedCellsCache){const t=e[lastDetailContextKey];wijmo_react_base_1.selectiveDomRender(this._templateFn(t),e,!0)}}}exports.DirectiveFlexGridDetail=DirectiveFlexGridDetail;