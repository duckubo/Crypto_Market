/*!
    *
    * Wijmo Library 5.20242.21
    * https://developer.mescius.com/wijmo
    *
    * Copyright(c) MESCIUS inc. All rights reserved.
    *
    * Licensed under the End-User License Agreement For MESCIUS Wijmo Software.
    * us.sales@mescius.com
    * https://developer.mescius.com/wijmo/licensing
    *
    */

var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)};import{forwardRef}from"react";import{ControlBaseMeta,selectiveDomRender,selectiveDomUnmount,useWjComponentBase,useWjComponentChildBase}from"@mescius/wijmo.react.base";import*as React from"react";import*as ReactDOM from"react-dom";import*as wjcCore from"@mescius/wijmo";import*as wjcInput from"@mescius/wijmo.input";var wjItemTemplatePropertyKey="$__wjItemTemplate",wjItemTemplateProperty="wjItemTemplate";function updateWjItemTemplateProp(e,t){if(e){if(!e[wjItemTemplatePropertyKey]&&t[wjItemTemplateProperty]){e[wjItemTemplatePropertyKey]=new ItemTemplate(e);e[wjItemTemplatePropertyKey].wjItemTemplate=wjcCore.asFunction(t[wjItemTemplateProperty])}else if(e[wjItemTemplatePropertyKey]&&!t[wjItemTemplateProperty]){var n=e[wjItemTemplatePropertyKey];e[wjItemTemplatePropertyKey]=null;n._detachFromControl()}if(e[wjItemTemplatePropertyKey]&&t[wjItemTemplateProperty]){e[wjItemTemplatePropertyKey].wjItemTemplate=wjcCore.asFunction(t[wjItemTemplateProperty]);e[wjItemTemplatePropertyKey]._updateTemplateItems()}}}export var ListBoxMeta={inputs:ControlBaseMeta.inputs.concat(["caseSensitiveSearch","checkedItems","checkedMemberPath","displayMemberPath","isContentHtml","itemFormatter","itemRole","itemsSource","maxHeight","selectedIndex","selectedItem","selectedValue","selectedValuePath","showGroups","virtualizationThreshold"]),events:ControlBaseMeta.events.concat(["checkedItemsChanged","formatItem","itemChecked","itemsChanged","loadedItems","loadingItems","selectedIndexChanged"])};export var ListBox=forwardRef((function(e,t){var n=useWjComponentBase({ref:t,properties:ListBoxMeta.inputs,events:ListBoxMeta.events,props:e,constructor:wjcInput.ListBox,initControl:function(t){updateWjItemTemplateProp(t,e)}});updateWjItemTemplateProp(n.wjControl,e);return n.renderResult}));export var MultiSelectListBoxMeta={inputs:ControlBaseMeta.inputs.concat(["caseSensitiveSearch","checkOnFilter","checkedItems","checkedMemberPath","delay","displayMemberPath","filterInputPlaceholder","isContentHtml","itemsSource","selectAllLabel","selectedIndex","showFilterInput","showGroups","showSelectAllCheckbox","virtualizationThreshold"]),events:ControlBaseMeta.events.concat(["checkedItemsChanged","selectedIndexChanged"])};export var MultiSelectListBox=forwardRef((function(e,t){return useWjComponentBase({ref:t,properties:MultiSelectListBoxMeta.inputs,events:MultiSelectListBoxMeta.events,props:e,constructor:wjcInput.MultiSelectListBox}).renderResult}));export var DropDownMeta={inputs:ControlBaseMeta.inputs.concat(["autoExpandSelection","clickAction","dropDownCssClass","inputType","isAnimated","isDroppedDown","isReadOnly","isRequired","placeholder","showDropDownButton","text"]),events:ControlBaseMeta.events.concat(["isDroppedDownChanged","isDroppedDownChanging","textChanged"])};export var ComboBoxMeta={inputs:DropDownMeta.inputs.concat(["caseSensitiveSearch","displayMemberPath","handleWheel","headerPath","isContentHtml","isEditable","itemFormatter","itemsSource","maxDropDownHeight","maxDropDownWidth","selectedIndex","selectedItem","selectedValue","selectedValuePath","showGroups","trimText","virtualizationThreshold"]),events:DropDownMeta.events.concat(["formatItem","itemsSourceChanged","selectedIndexChanged"])};export var ComboBox=forwardRef((function(e,t){var n=useWjComponentBase({ref:t,properties:ComboBoxMeta.inputs,events:ComboBoxMeta.events,props:e,constructor:wjcInput.ComboBox,initControl:function(t){updateWjItemTemplateProp(t,e)}});updateWjItemTemplateProp(n.wjControl,e);return n.renderResult}));export var AutoCompleteMeta={inputs:ComboBoxMeta.inputs.concat(["beginsWithSearch","cssMatch","delay","itemsSourceFunction","maxItems","minLength","searchMemberPath"]),events:ComboBoxMeta.events.slice()};export var AutoComplete=forwardRef((function(e,t){var n=useWjComponentBase({ref:t,properties:AutoCompleteMeta.inputs,events:AutoCompleteMeta.events,props:e,constructor:wjcInput.AutoComplete,initControl:function(t){updateWjItemTemplateProp(t,e)}});updateWjItemTemplateProp(n.wjControl,e);return n.renderResult}));export var CalendarMeta={inputs:ControlBaseMeta.inputs.concat(["displayMonth","firstDayOfWeek","formatDayHeaders","formatDays","formatMonths","formatYear","formatYearMonth","handleWheel","isReadOnly","itemFormatter","itemValidator","max","min","monthCount","monthView","rangeEnd","rangeMax","rangeMin","repeatButtons","selectionMode","showHeader","showMonthPicker","showYearPicker","value","weeksAfter","weeksBefore"]),events:ControlBaseMeta.events.concat(["displayMonthChanged","formatItem","rangeChanged","rangeEndChanged","valueChanged"])};export var Calendar=forwardRef((function(e,t){return useWjComponentBase({ref:t,properties:CalendarMeta.inputs,events:CalendarMeta.events,props:e,constructor:wjcInput.Calendar}).renderResult}));export var ColorPickerMeta={inputs:ControlBaseMeta.inputs.concat(["palette","showAlphaChannel","showColorString","value"]),events:ControlBaseMeta.events.concat(["valueChanged"])};export var ColorPicker=forwardRef((function(e,t){return useWjComponentBase({ref:t,properties:ColorPickerMeta.inputs,events:ColorPickerMeta.events,props:e,constructor:wjcInput.ColorPicker}).renderResult}));export var InputMaskMeta={inputs:ControlBaseMeta.inputs.concat(["inputType","isReadOnly","isRequired","mask","overwriteMode","placeholder","promptChar","rawValue","value"]),events:ControlBaseMeta.events.concat(["valueChanged"])};export var InputMask=forwardRef((function(e,t){return useWjComponentBase({ref:t,properties:InputMaskMeta.inputs,events:InputMaskMeta.events,props:e,constructor:wjcInput.InputMask}).renderResult}));export var InputColorMeta={inputs:DropDownMeta.inputs.concat(["palette","showAlphaChannel","showColorString","text","value"]),events:DropDownMeta.events.concat(["valueChanged"])};export var InputColor=forwardRef((function(e,t){return useWjComponentBase({ref:t,properties:InputColorMeta.inputs,events:InputColorMeta.events,props:e,constructor:wjcInput.InputColor}).renderResult}));export var MultiSelectMeta={inputs:ComboBoxMeta.inputs.concat(["caseSensitiveSearch","checkOnFilter","checkedItems","checkedMemberPath","delay","filterInputPlaceholder","headerFormat","headerFormatter","maxHeaderItems","selectAllLabel","showFilterInput","showSelectAllCheckbox"]),events:ComboBoxMeta.events.concat(["checkedItemsChanged"])};export var MultiSelect=forwardRef((function(e,t){var n=useWjComponentBase({ref:t,properties:MultiSelectMeta.inputs,events:MultiSelectMeta.events,props:e,constructor:wjcInput.MultiSelect,initControl:function(t){updateWjItemTemplateProp(t,e)}});updateWjItemTemplateProp(n.wjControl,e);return n.renderResult}));export var MultiAutoCompleteMeta={inputs:AutoCompleteMeta.inputs.concat(["maxSelectedItems","selectedItems","selectedMemberPath","showDropDownButton"]),events:AutoCompleteMeta.events.concat(["selectedItemsChanged"])};export var MultiAutoComplete=forwardRef((function(e,t){return useWjComponentBase({ref:t,properties:MultiAutoCompleteMeta.inputs,events:MultiAutoCompleteMeta.events,props:e,constructor:wjcInput.MultiAutoComplete}).renderResult}));export var InputNumberMeta={inputs:ControlBaseMeta.inputs.concat(["format","handleWheel","inputType","isReadOnly","isRequired","max","min","placeholder","repeatButtons","showSpinner","step","text","value"]),events:ControlBaseMeta.events.concat(["textChanged","valueChanged"])};export var InputNumber=forwardRef((function(e,t){return useWjComponentBase({ref:t,properties:InputNumberMeta.inputs,events:InputNumberMeta.events,props:e,constructor:wjcInput.InputNumber}).renderResult}));export var InputDateMeta={inputs:DropDownMeta.inputs.concat(["alwaysShowCalendar","closeOnSelection","format","handleWheel","inputType","itemFormatter","itemValidator","mask","max","min","monthCount","predefinedRanges","rangeEnd","rangeMax","rangeMin","repeatButtons","selectionMode","separator","showHeader","showMonthPicker","showYearPicker","text","value","weeksAfter","weeksBefore","keepInvalidText"]),events:DropDownMeta.events.concat(["rangeChanged","rangeEndChanged","valueChanged"])};export var InputDate=forwardRef((function(e,t){return useWjComponentBase({ref:t,properties:InputDateMeta.inputs,events:InputDateMeta.events,props:e,constructor:wjcInput.InputDate}).renderResult}));export var InputTimeMeta={inputs:ComboBoxMeta.inputs.concat(["format","inputType","mask","max","min","step","text","value"]),events:ComboBoxMeta.events.concat(["valueChanged"])};export var InputTime=forwardRef((function(e,t){return useWjComponentBase({ref:t,properties:InputTimeMeta.inputs,events:InputTimeMeta.events,props:e,constructor:wjcInput.InputTime}).renderResult}));export var InputDateTimeMeta={inputs:InputDateMeta.inputs.concat(["timeFormat","timeMax","timeMin","timeStep"]),events:InputDateMeta.events.slice()};export var InputDateTime=forwardRef((function(e,t){return useWjComponentBase({ref:t,properties:InputDateTimeMeta.inputs,events:InputDateTimeMeta.events,props:e,constructor:wjcInput.InputDateTime}).renderResult}));export var InputDateRangeMeta={inputs:InputDateMeta.inputs.slice(),events:InputDateMeta.events.slice()};export var InputDateRange=forwardRef((function(e,t){return useWjComponentBase({ref:t,properties:InputDateRangeMeta.inputs,events:InputDateRangeMeta.events,props:e,constructor:wjcInput.InputDateRange}).renderResult}));export var MenuMeta={inputs:ComboBoxMeta.inputs.concat(["closeOnLeave","command","commandParameterPath","commandPath","header","isButton","openOnHover","owner","subItemsPath","ariaLabel","autoSelectOnFocus"]),events:ComboBoxMeta.events.concat(["itemClicked"])};function getReactDOM(){return ReactDOM}function _getContextMenuElements(e){var t=[];(wjcCore.isArray(e)?e:[e]).forEach((function(e){if(e){var n=null;if("string"==typeof e)n=document.getElementById(e);else if("object"==typeof e){var o=e.hostElement?e.hostElement:e.current;if(o)if(o instanceof HTMLElement)n=o;else if(o instanceof wjcCore.Control)n=o.hostElement;else if(o.control&&o.control instanceof wjcCore.Control)n=o.control.hostElement;else{var r=getReactDOM().findDOMNode;r&&(n=r(o))}}n&&t.push(n)}}));return t}export var Menu=forwardRef((function(e,t){var n=React.useRef({}),updateHeader=function(e){e.header=e._definedHeader||"";var t=e.selectedItem;if(null!=e.selectedValue&&t&&e.displayMemberPath){var n=null;if(t instanceof _MenuItem){var o=t.itemRoot;n=o?o.innerHTML:t[e.displayMemberPath]}null!=n&&(e.header+=": <b>"+n+"</b>")}},o=useWjComponentBase({ref:t,properties:MenuMeta.inputs,events:MenuMeta.events,props:e,constructor:wjcInput.Menu,prePropsInit:function(t){t._definedHeader=e.header;t.listBox.formatItem.addHandler((function(e,t){if(t.data instanceof _MenuItem||t.data instanceof _MenuSeparator){t.item.textContent="";t.data.updateItem(t.item)}}));queueMicrotask((function(){return updateHeader(t)}))},initControl:function(t){updateWjItemTemplateProp(t,e);t._definedHeader=e.header;t.selectedIndexChanged.addHandler((function(){updateHeader(t)}));if(t.itemsSource&&t.itemsSource.length){Array.from(t.itemsSource).find((function(e){return e instanceof _MenuItem}));t.itemsSource[0]instanceof _MenuItem&&1==t.itemsSource.length&&t.selectedIndex<0&&(t.selectedIndex=0)}},customProps:{header:function(e,t){if(e._definedHeader!=t){e._definedHeader=t;e.header=t;updateHeader(e)}},contextMenuOf:function(e,t){n.current.contextMenuOf||(n.current.contextMenuOf=[]);e.hostElement.style.display=t?"none":"inline-table";for(var o=0,r=n.current.contextMenuOf;o<r.length;o++){var a=r[o];a.el.removeEventListener("contextmenu",a.handler)}n.current.contextMenuOf=[];if(t)for(var _loop_1=function(t){var listener=function(n){if(!wjcCore.closest(n.target,"[disabled]")){var o=e;if(o&&o.dropDown){n.preventDefault();n.stopPropagation();o.owner=t;o.show(n)}}};t.addEventListener("contextmenu",listener);n.current.contextMenuOf.push({el:t,handler:listener})},s=0,i=_getContextMenuElements(t);s<i.length;s++){_loop_1(i[s])}},value:function(e,t){e.selectedValue=t;updateHeader(e)}}});o.wjControl&&(o.wjControl._definedHeader=e.header);updateWjItemTemplateProp(o.wjControl,e);if(o.wjControl&&o.wjControl.itemsSource)for(var r=0,a=o.wjControl.itemsSource;r<a.length;r++){if(a[r]instanceof _MenuItem){o.wjControl.listBox.loadList();break}}return o.renderResult}));export var MenuItemMeta={inputs:["children","cmd","cmdParam","value"],events:[]};var _MenuItem=function(){function _MenuItem(e,t){this.children=[];this.value=null;this.cmd=null;this.cmdParam=null;this._parent=e;wjcCore.copy(this,t);this._init(t)}_MenuItem.prototype._init=function(e){this._parent.displayMemberPath||(this._parent.displayMemberPath="header");this._parent.selectedValuePath||(this._parent.selectedValuePath="value");this._parent.commandPath||(this._parent.commandPath="cmd");this._parent.commandParameterPath||(this._parent.commandParameterPath="cmdParam")};_MenuItem.prototype.updateItem=function(e){selectiveDomUnmount(e);selectiveDomRender(this.children,e);this.itemRoot=e};return _MenuItem}();export var MenuItem=forwardRef((function(e,t){var n=useWjComponentChildBase({ref:t,properties:MenuItemMeta.inputs,events:MenuItemMeta.events,props:e,constructor:_MenuItem,needParentInstance:!0,parentProp:"itemsSource",isParentPropArray:!0,assignedToParent:!0});return __assign({$_wjComponent:!0},n)}));export var MenuSeparator=forwardRef((function(e,t){var n=useWjComponentChildBase({ref:t,properties:[],events:[],props:e,constructor:_MenuSeparator,needParentInstance:!0,parentProp:"itemsSource",isParentPropArray:!0,assignedToParent:!0});return __assign({$_wjComponent:!0},n)}));var _MenuSeparator=function(){function _MenuSeparator(e,t){}_MenuSeparator.prototype.updateItem=function(e){wjcCore.createElement("<div></div>",e,{width:"100%",height:"1px",backgroundColor:"lightgray"});wjcCore.addClass(e,"wj-state-disabled");wjcCore.setAttribute(e,"role","separator",!1)};return _MenuSeparator}();export var PopupMeta={inputs:ControlBaseMeta.inputs.concat(["content","dialogResult","dialogResultEnter","dialogResultSubmit","fadeIn","fadeOut","hideTrigger","isDraggable","isResizable","isVisible","modal","owner","position","removeOnHide","showTrigger"]),events:ControlBaseMeta.events.concat(["dragged","dragging","hidden","hiding","positionChanged","positionChanging","resized","resizing","showing","shown","sizeChanged","sizeChanging"])};function updatePopupContent(e,t){selectiveDomRender(t,e.hostElement)}export var Popup=forwardRef((function(e,t){var n=useWjComponentBase({ref:t,properties:PopupMeta.inputs,events:PopupMeta.events,props:e,constructor:wjcInput.Popup,initControl:function(t){t.removeOnHide=!1;updatePopupContent(t,e.children)}});n.wjControl&&updatePopupContent(n.wjControl,e.children);return n.renderResult}));export var CollectionViewNavigatorMeta={inputs:ControlBaseMeta.inputs.concat(["byPage","cv","headerFormat","repeatButtons"]),events:ControlBaseMeta.events.slice()};export var CollectionViewNavigator=forwardRef((function(e,t){return useWjComponentBase({ref:t,properties:CollectionViewNavigatorMeta.inputs,events:CollectionViewNavigatorMeta.events,props:e,constructor:wjcInput.CollectionViewNavigator}).renderResult}));var ItemTemplate=function(){function ItemTemplate(e){this._templateItems=[];this.ownerControl=e;this.listBox=this._getListBox(this.ownerControl);this._attachToControl()}ItemTemplate.prototype._updateTemplateItems=function(){var e=this;this._templateItems.forEach((function(t){selectiveDomRender(e._createItemElTpl(t),t.itemEl)}))};ItemTemplate.prototype._attachToControl=function(){this.listBox.formatItem.addHandler(this._fmtItem,this);this.listBox.loadingItems.addHandler(this._destroyTemplateItems,this);this.ownerControl.invalidate()};ItemTemplate.prototype._detachFromControl=function(){this.listBox.formatItem.removeHandler(this._fmtItem,this);this._destroyTemplateItems()};ItemTemplate.prototype._fmtItem=function(e,t){var n=t.item,o={control:e,item:t.data,itemIndex:t.index};this._templateItems.push(__assign({},o,{itemEl:n}));if(wjcCore.isFunction(this.wjItemTemplate)){selectiveDomUnmount(n);selectiveDomRender(this._createItemElTpl(o),n)}};ItemTemplate.prototype._getListBox=function(e){return e instanceof wjcInput.ListBox?e:e.listBox};ItemTemplate.prototype._destroyTemplateItems=function(){this._templateItems.forEach((function(e){selectiveDomUnmount(e.itemEl)}));this._templateItems=[]};ItemTemplate.prototype._createItemElTpl=function(e){return React.createElement("div",{},this.wjItemTemplate({control:e.control,item:e.item,itemIndex:e.itemIndex}))};return ItemTemplate}();